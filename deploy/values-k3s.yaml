## Supabase K3s Values
## This file overrides the default values.yaml for K3s deployment
## with Longhorn storage, Nginx ingress, and cert-manager

## 1. Secrets - IMPORTANT: Change these before deploying!
secret:
  jwt:
    # Generate with: openssl rand -base64 64 | tr -d '\n'
    anonKey: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyAgCiAgICAicm9sZSI6ICJhbm9uIiwKICAgICJpc3MiOiAic3VwYWJhc2UtZGVtbyIsCiAgICAiaWF0IjogMTY0MTc2OTIwMCwKICAgICJleHAiOiAxNzk5NTM1NjAwCn0.dc_X5iR_VP_qT0zsiyj_I_OZ2T9FtRU2BBNWN8Bu4GEeyJ0eXAiOiAiSldUIiwiYWxnIjogIkhTMjU2In0.ewogICJyb2xlIjogImFub24iLAogICJpc3MiOiAic3VwYWJhc2UiLAogICJpYXQiOiAxNzYwMzk5NjgyLAogICJleHAiOiAxOTE4MDc5NjgyCn0.xzjJFfvYNysJZpnx17tlSdmqJBxRQxFg2xxubV1-d0g"
    serviceKey: "eyJ0eXAiOiAiSldUIiwiYWxnIjogIkhTMjU2In0.ewogICJyb2xlIjogInNlcnZpY2Vfcm9sZSIsCiAgImlzcyI6ICJzdXBhYmFzZSIsCiAgImlhdCI6IDE3NjAzOTk2ODIsCiAgImV4cCI6IDE5MTgwNzk2ODIKfQ.BGsO7h-Bh_kuQJj_0qhGWaBeBthMZ4WNzSKJXZfR3fE"
    # Generate with: openssl rand -base64 64 | tr -d '\n'
    secret: "02oM6PvAtlA8u698yMCbEyGitGDBFG6fnMGFwgV+I2wHoQIpx2a8IL3BwdfUECxvsG6woEJooGXlFTgBgHrCFw=="

  db:
    # Generate with: openssl rand -base64 32 | tr -d '\n'
    password: "unQ+nE0zLJzp1Kq6hOyitSohJNgd6VU1tMifBNg7bik="
    database: "postgres"

  analytics:
    # Generate with: openssl rand -base64 32 | tr -d '\n'
    publicAccessToken: "z/uVNNcJGrRVXQ7VmIxx2uO0erUuJwGAkI4xJxhzvfg="
    privateAccessToken: "eiUv2yJ138Bg56z3lQ35mcJIGDzVynDP7n2Tqyqd/pk="

  smtp:
    username: "no-reply@spalce.net"
    password: "F[Oo+7jf9IeFQ,p5THY8.M&xig)e&g"

  dashboard:
    username: "Admin"
    # Generate with: openssl rand -base64 24 | tr -d '\n'
    password: "Ziu0cNUv3mxDxVmFSnPlBD59gKGcwQi1"
    openAiApiKey: ""

  s3:
    keyId: "minioadmin"
    accessKey: "minioadmin"

  realtime:
    # Generate with: openssl rand -base64 64 | tr -d '\n'
    secretKeyBase: "7hWs5SEFc8Zk/bIS7V8sztyH8LTm8+/FyX6G1a7P4FiUxCkbFYAL3hZ30h+k9LoE6bhb8uKK+EA9aehZQfbwdQ=="

  meta:
    # Generate with: openssl rand -hex 32
    cryptoKey: "c387db3c29197c94f2760c4a206e56d9a54e3014008238ab79f1730a826fd34c"

## 2. Database - Using Longhorn for persistent storage
db:
  enabled: true
  
  persistence:
    enabled: true
    storageClassName: "longhorn"
    size: 20Gi
    accessModes:
      - ReadWriteOnce
  
  resources:
    requests:
      memory: "1Gi"
      cpu: "500m"
    limits:
      memory: "2Gi"
      cpu: "2000m"
  
  autoscaling:
    enabled: false

## 3. Studio
studio:
  enabled: true
  
  environment:
    SUPABASE_PUBLIC_URL: https://api.credaction.com
    DEFAULT_ORGANIZATION_NAME: "Credaction"
    DEFAULT_PROJECT_NAME: "Production"
    NEXT_PUBLIC_ENABLE_LOGS: "true"
    NEXT_ANALYTICS_BACKEND_PROVIDER: postgres
  
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  
  autoscaling:
    enabled: false

## 4. Auth
auth:
  enabled: true
  
  environment:
    API_EXTERNAL_URL: https://api.credaction.com
    GOTRUE_SITE_URL: https://api.credaction.com
    GOTRUE_URI_ALLOW_LIST: "*"
    GOTRUE_DISABLE_SIGNUP: "false"
    GOTRUE_EXTERNAL_EMAIL_ENABLED: "true"
    GOTRUE_MAILER_AUTOCONFIRM: "false"
    # Configure SMTP settings
    GOTRUE_SMTP_ADMIN_EMAIL: "info@spalce.net"
    GOTRUE_SMTP_HOST: "server.spalce.net"
    GOTRUE_SMTP_PORT: "587"
    GOTRUE_SMTP_SENDER_NAME: "CredAction"
  
  resources:
    requests:
      memory: "128Mi"
      cpu: "100m"
    limits:
      memory: "256Mi"
      cpu: "500m"
  
  autoscaling:
    enabled: false

## 5. REST
rest:
  enabled: true
  
  resources:
    requests:
      memory: "128Mi"
      cpu: "100m"
    limits:
      memory: "256Mi"
      cpu: "500m"
  
  autoscaling:
    enabled: false

## 6. Realtime
realtime:
  enabled: true
  
  resources:
    requests:
      memory: "128Mi"
      cpu: "100m"
    limits:
      memory: "256Mi"
      cpu: "500m"
  
  autoscaling:
    enabled: false

## 7. Meta
meta:
  enabled: true
  
  resources:
    requests:
      memory: "128Mi"
      cpu: "100m"
    limits:
      memory: "256Mi"
      cpu: "500m"
  
  autoscaling:
    enabled: false

## 8. Storage - Using Longhorn for persistent volumes
storage:
  enabled: true
  
  persistence:
    enabled: true
    storageClassName: "longhorn"
    size: 50Gi
    accessModes:
      - ReadWriteOnce
  
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  
  autoscaling:
    enabled: false

## 9. Image Proxy
imgproxy:
  enabled: true
  
  persistence:
    enabled: true
    storageClassName: "longhorn"
    size: 10Gi
    accessModes:
      - ReadWriteOnce
  
  resources:
    requests:
      memory: "128Mi"
      cpu: "100m"
    limits:
      memory: "256Mi"
      cpu: "500m"
  
  autoscaling:
    enabled: false

## 10. Kong - API Gateway with Nginx Ingress
kong:
  enabled: true
  
  ingress:
    enabled: true
    className: "nginx"
    annotations:
      nginx.ingress.kubernetes.io/ssl-redirect: "true"
      nginx.ingress.kubernetes.io/proxy-body-size: "50m"
      nginx.ingress.kubernetes.io/proxy-read-timeout: "600"
      nginx.ingress.kubernetes.io/proxy-send-timeout: "600"
    
    hosts:
      - host: api.credaction.com
        paths:
          - path: /
            pathType: Prefix
    
    tls:
      - secretName: credaction-api-tls
        hosts:
          - api.credaction.com
  
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  
  autoscaling:
    enabled: false

## 11. Analytics
analytics:
  enabled: true
  
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  
  autoscaling:
    enabled: false

## 12. Vector
vector:
  enabled: true
  
  resources:
    requests:
      memory: "128Mi"
      cpu: "100m"
    limits:
      memory: "256Mi"
      cpu: "500m"
  
  autoscaling:
    enabled: false

## 13. Functions
functions:
  enabled: true
  
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  
  autoscaling:
    enabled: false

## 14. Minio - S3-compatible storage with Longhorn
minio:
  enabled: true
  
  persistence:
    enabled: true
    storageClassName: "longhorn"
    size: 20Gi
    accessModes:
      - ReadWriteOnce
  
  resources:
    requests:
      memory: "512Mi"
      cpu: "250m"
    limits:
      memory: "1Gi"
      cpu: "1000m"
  
  autoscaling:
    enabled: false
